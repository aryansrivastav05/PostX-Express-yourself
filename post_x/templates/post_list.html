{% extends "layout.html" %}

{% block content %}
<div class="page-header page-hero" style="text-align:center;margin:2rem 0 3rem;padding:3rem 1rem;border-radius:12px;background:linear-gradient(135deg, rgba(59,130,246,0.12), rgba(59,130,246,0.06));box-shadow:0 6px 18px rgba(15,23,42,0.06)">
    <h1 style="font-size:2rem;font-weight:700;margin-bottom:1rem">Welcome to PostX</h1>
    <p style="color:var(--text-light);max-width:36rem;margin:0 auto 1.5rem">
        Share your thoughts and moments with the community. Create a post, engage with others, and discover interesting content.
    </p>
    {% if request.user.is_authenticated %}
        <a class="btn btn-primary" href="{% url 'post_create' %}" style="font-size:1rem;padding:0.75rem 1.5rem">
            <svg style="width:1.25rem;height:1.25rem;margin-right:0.5rem" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
            </svg>
            Create a Post
        </a>
    {% else %}
        <a class="btn" href="{% url 'login' %}?next={% url 'post_create' %}">
            Sign in to Create Posts
        </a>
    {% endif %}
</div>

<div class="grid">
    {% for post in posts %}
        <div class="card post-card">
            <div class="card-header" style="padding:1rem;display:flex;align-items:center;gap:0.75rem;border-bottom:1px solid var(--border)">
                <div class="avatar" style="width:2.5rem;height:2.5rem;border-radius:9999px;background:var(--primary);color:white;display:flex;align-items:center;justify-content:center;font-weight:500">
                    {{ post.user.username|make_list|first|upper }}
                </div>
                <div>
                    <div style="font-weight:500">{{ post.user.username }}</div>
                    <div style="font-size:0.875rem;color:var(--text-light)">
                        {{ post.created_at|date:"M j, Y" }}
                    </div>
                </div>
            </div>
            
            {% if post.photo %}
                <div class="image-container" style="position:relative;padding-top:56.25%;overflow:hidden;background:var(--background)">
                    <img src="{{ post.photo.url }}" alt="Post image" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover">
                </div>
            {% endif %}
            
            <div class="card-body" style="padding:1.25rem">
                <p class="card-text" style="margin-bottom:1.25rem;white-space:pre-wrap">{{ post.text }}</p>
                
                {% if request.user.is_authenticated and post.user == request.user %}
                    <div class="card-actions" style="display:flex;gap:0.75rem">
                        <a href="{% url 'post_edit' post.id %}" class="btn btn-primary" style="font-size:0.875rem">
                            <svg style="width:1rem;height:1rem;margin-right:0.375rem" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                            </svg>
                            Edit
                        </a>
                        <a href="{% url 'post_delete' post.id %}" class="btn btn-danger" style="font-size:0.875rem">
                            <svg style="width:1rem;height:1rem;margin-right:0.375rem" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                            </svg>
                            Delete
                        </a>
                    </div>
                {% endif %}
            </div>
        </div>
    {% empty %}
        <div style="text-align:center;grid-column:1/-1;padding:3rem 1rem">
            <div style="color:var(--text-light);margin-bottom:1rem">No posts available yet.</div>
            {% if request.user.is_authenticated %}
                <a href="{% url 'post_create' %}" class="btn btn-primary">Create the First Post</a>
            {% else %}
                <a href="{% url 'login' %}?next={% url 'post_create' %}" class="btn">Sign in to Create Posts</a>
            {% endif %}
        </div>
    {% endfor %}
</div>

<style>
    .post-card {
        animation: fadeIn 0.5s ease-out;
        animation-fill-mode: both;
    }
    
    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    /* Stagger animations with CSS-only approach */
    .post-card:nth-child(1) { animation-delay: 0s; }
    .post-card:nth-child(2) { animation-delay: 0.1s; }
    .post-card:nth-child(3) { animation-delay: 0.2s; }
    .post-card:nth-child(4) { animation-delay: 0.3s; }
    .post-card:nth-child(5) { animation-delay: 0.4s; }
    .post-card:nth-child(6) { animation-delay: 0.5s; }
    .post-card:nth-child(7) { animation-delay: 0.6s; }
    .post-card:nth-child(8) { animation-delay: 0.7s; }
    .post-card:nth-child(9) { animation-delay: 0.8s; }
    .post-card:nth-child(10) { animation-delay: 0.9s; }

    .image-container {
        position: relative;
        overflow: hidden;
    }

    .image-container img {
        transition: transform 0.3s ease;
    }

    .post-card:hover .image-container img {
        transform: scale(1.05);
    }

    .btn svg {
        transition: transform 0.2s ease;
    }

    .btn:hover svg {
        transform: scale(1.1);
    }

    .avatar {
        background: linear-gradient(135deg, var(--primary), var(--primary-hover));
    }

    /* Homepage hero specific styling */
    .page-hero {
        background-image: linear-gradient(180deg, rgba(255,255,255,0.6), rgba(255,255,255,0.2));
        border: 1px solid rgba(255,255,255,0.3);
        backdrop-filter: blur(4px);
    }

    .page-hero h1 {
        color: var(--primary);
        text-shadow: 0 1px 0 rgba(255,255,255,0.6);
    }

    .page-hero p {
        color: var(--text-light);
        font-size: 1rem;
    }
</style>
{% endblock %}
